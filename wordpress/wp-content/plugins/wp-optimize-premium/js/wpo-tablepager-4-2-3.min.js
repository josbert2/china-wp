WPO_TablePager=function(e){function t(){m.size=parseInt(document.querySelector(m.cssPageSize).value),document.querySelector(m.cssPageDisplay).addEventListener("change",function(e){e.preventDefault();var t=e.target;""===t.value||isNaN(parseInt(t.value))||(m.page=parseInt(t.value)-1,u())}),document.querySelector(m.cssFirst).addEventListener("click",function(e){e.preventDefault(),r()}),document.querySelector(m.cssPrev).addEventListener("click",function(e){e.preventDefault(),c()}),document.querySelector(m.cssNext).addEventListener("click",function(e){e.preventDefault(),s()}),document.querySelector(m.cssLast).addEventListener("click",function(e){e.preventDefault(),i()}),document.querySelector(m.cssPageSize).addEventListener("change",function(e){e.preventDefault(),a(parseInt(e.target.value))})}function n(){document.querySelector(m.cssPageDisplay).value=m.page+1,document.querySelector(m.cssPageDisplayCount).textContent=[m.separator,m.totalPages].join("")}function a(e){m.size=e,m.totalPages=Math.ceil(m.totalRows/m.size),m.pagerPositionSet=!1,u(),o()}function o(){if(!m.pagerPositionSet&&m.positionFixed){var e=P.getBoundingClientRect().top+window.scrollY,t=P.offsetHeight;m.container.style.top=[e+t,"px"].join(""),m.container.style.position="absolute",m.pagerPositionSet=!0}}function r(){m.page=0,u()}function i(){m.page=m.totalPages-1,u()}function s(){m.page++,u()}function c(){m.page--,u()}function u(){l(),f()?g():d(m.rowsCopy)}function l(){m.page>=m.totalPages&&(m.page=m.totalPages-1),m.page<0&&(m.page=0)}function p(){P.tBodies[0].innerHTML=""}function d(e){var t=P.tBodies[0];if(p(),f())e.data.forEach(function(n){var a=e.hasOwnProperty("id_key")?e.id_key:"ID";t.appendChild(v(a,n,e.columns))});else for(var a=m.page*m.size,r=Math.min(a+m.size,e.length),s=a;s<r;s++)e[s].forEach(function(e){t.appendChild(e)});o(),m.page>=m.totalPages&&m.totalPages>0&&i(),n()}function f(){return"object"==typeof m.dataSource&&m.dataSource.hasOwnProperty("fetch")}function g(){P.dispatchEvent(new CustomEvent("load_start",{})),m.dataSource.fetch(m.page*m.size,m.size).then(function(e){try{e=JSON.parse(e)}catch(t){return void alert(wpoptimize.error_unexpected_response)}return e&&e.errors&&e.errors.length?void alert(wpoptimize.error_unexpected_response):(P.dispatchEvent(new CustomEvent("load_end",{detail:{response:e}})),m.totalRows=parseInt(e.result.total),m.totalPages=Math.ceil(m.totalRows/m.size),d(e.result),void 0)})["catch"](function(){alert(wpoptimize.error_unexpected_response)})}function v(e,t,n){var a=document.createElement("tr"),o=document.createElement("td");o.innerHTML=['<input type="checkbox" value="',t[e],'">'].join(""),a.appendChild(o);for(var r in n)if(n.hasOwnProperty(r)){var i=document.createElement("td");if(t.hasOwnProperty(r))if("object"==typeof t[r])i.innerHTML=['<a href="',t[r].url,'" target="_blank">',t[r].text,"</a>"].join("");else{var s=document.createElement("textarea");s.innerHTML=t[r],i.textContent=s.value}else i.textContent="";a.appendChild(i)}return a}var y={size:10,page:0,totalRows:0,totalPages:0,container:null,cssNext:".next",cssPrev:".prev",cssFirst:".first",cssLast:".last",cssPageDisplay:".pagedisplay",cssPageDisplayCount:".pagedisplay-count",cssPageSize:".pagesize",separator:"/",positionFixed:!0,dataSource:null},m=Object.assign({},y,e),P=e.table;return t(),{loadTableData:g}},WPO_Table_DataSource=function(e){function t(t,n){e[t]=n}function n(t,n){return e.offset="undefined"==typeof t?e.offset:t,e.limit="undefined"==typeof n?e.limit:n,wp_optimize.send_command("preview",e)}return{set_option:t,fetch:n}};